<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Chat with AI</title>
  <!-- Include HTMX library -->
  <script src="https://unpkg.com/htmx.org@1.9.2"></script>
  <style>
    /* Reset default margin and padding */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body, html {
  height: 100%;
  font-family: Arial, sans-serif;
  background-color: #f4f7fa;
}

/* Make the messanger component take up the entire page */
.messanger {
  height: 100%;
  display: flex;
  flex-direction: column;
  max-width: 100%;
  background-color: #ffffff;
  border-radius: 10px;
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
}

/* Header styling */
header {
  background-color: #4CAF50;
  color: white;
  padding: 20px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  border-top-left-radius: 10px;
  border-top-right-radius: 10px;
}

header h1 {
  margin: 0;
}

header svg {
  width: 40px;
  height: 40px;
}

form {
  display: inline-block;
}

select {
  padding: 5px;
  border-radius: 5px;
  border: 1px solid #ddd;
}

button {
  padding: 8px 16px;
  margin-left: 10px;
  background-color: #4CAF50;
  color: white;
  border: none;
  border-radius: 5px;
  cursor: pointer;
}

button:hover {
  background-color: #45a049;
}

/* Make the main section take all remaining space */
main {
  flex: 1;
  padding: 20px;
  overflow-y: auto;
  background-color: #f9f9f9;
}

/* Footer */
footer {
  background-color: #f1f1f1;
  padding: 15px;
  display: flex;
  flex-direction: column;
  gap: 10px;
  border-bottom-left-radius: 10px;
  border-bottom-right-radius: 10px;
}

footer form {
  display: flex;
  justify-content: space-between;
}

footer input[type="text"] {
  width: 80%;
  padding: 8px;
  border-radius: 5px;
  border: 1px solid #ddd;
}

footer input[type="file"] {
  margin-top: 10px;
}

footer button {
  width: 15%;
}

#messages {
  margin-bottom: 10px;
}

.message {
  padding: 10px;
  margin-bottom: 15px;
  border-radius: 10px;
  background-color: #e1f5fe;
}

.message.user {
    display: flex;
    align-items: center;
    justify-content: flex-end;
    margin: 15px 0;
    padding: 10px;
    border-radius: 12px;
    background-color: #f0f5ff;
    max-width: 80%;
    box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1);
}

/* Styling for the message icon */
.message-icon {
    background-color: #4caf50; /* Green color for the icon background */
    color: white;
    border-radius: 50%;
    padding: 15px;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 10px;
    font-weight: bold;
    margin-right: 15px;
}

.icon-letter {
    font-size: 20px;
    font-weight: bold;
}
.message .message-icon img {
  width: 25px;
  height: 20px;
  border-radius: 50%;
}

.message p {
  margin: 0;
  padding: 0;
}

#alert {
  color: red;
  font-size: 14px;
  margin-top: 10px;
}

  </style>
</head>
<body>
  <div class="messanger">
    <header style="background-color: rgb(55, 55, 116);" >

      <div style="float: left;">
        <svg style="background-color: rgb(109, 95, 160); border: radiux 5px;" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="100" height="100" viewBox="0 0 50 50">
          <path d="M45.403,25.562c-0.506-1.89-1.518-3.553-2.906-4.862c1.134-2.665,0.963-5.724-0.487-8.237	c-1.391-2.408-3.636-4.131-6.322-4.851c-1.891-0.506-3.839-0.462-5.669,0.088C28.276,5.382,25.562,4,22.647,4	c-4.906,0-9.021,3.416-10.116,7.991c-0.01,0.001-0.019-0.003-0.029-0.002c-2.902,0.36-5.404,2.019-6.865,4.549	c-1.391,2.408-1.76,5.214-1.04,7.9c0.507,1.891,1.519,3.556,2.909,4.865c-1.134,2.666-0.97,5.714,0.484,8.234	c1.391,2.408,3.636,4.131,6.322,4.851c0.896,0.24,1.807,0.359,2.711,0.359c1.003,0,1.995-0.161,2.957-0.45	C21.722,44.619,24.425,46,27.353,46c4.911,0,9.028-3.422,10.12-8.003c2.88-0.35,5.431-2.006,6.891-4.535	C45.754,31.054,46.123,28.248,45.403,25.562z M35.17,9.543c2.171,0.581,3.984,1.974,5.107,3.919c1.049,1.817,1.243,4,0.569,5.967	c-0.099-0.062-0.193-0.131-0.294-0.19l-9.169-5.294c-0.312-0.179-0.698-0.177-1.01,0.006l-10.198,6.041l-0.052-4.607l8.663-5.001	C30.733,9.26,33,8.963,35.17,9.543z M29.737,22.195l0.062,5.504l-4.736,2.805l-4.799-2.699l-0.062-5.504l4.736-2.805L29.737,22.195z M14.235,14.412C14.235,9.773,18.009,6,22.647,6c2.109,0,4.092,0.916,5.458,2.488C28,8.544,27.891,8.591,27.787,8.651l-9.17,5.294	c-0.312,0.181-0.504,0.517-0.5,0.877l0.133,11.851l-4.015-2.258V14.412z M6.528,23.921c-0.581-2.17-0.282-4.438,0.841-6.383	c1.06-1.836,2.823-3.074,4.884-3.474c-0.004,0.116-0.018,0.23-0.018,0.348V25c0,0.361,0.195,0.694,0.51,0.872l10.329,5.81	L19.11,34.03l-8.662-5.002C8.502,27.905,7.11,26.092,6.528,23.921z M14.83,40.457c-2.171-0.581-3.984-1.974-5.107-3.919	c-1.053-1.824-1.249-4.001-0.573-5.97c0.101,0.063,0.196,0.133,0.299,0.193l9.169,5.294c0.154,0.089,0.327,0.134,0.5,0.134	c0.177,0,0.353-0.047,0.51-0.14l10.198-6.041l0.052,4.607l-8.663,5.001C19.269,40.741,17.001,41.04,14.83,40.457z M35.765,35.588	c0,4.639-3.773,8.412-8.412,8.412c-2.119,0-4.094-0.919-5.459-2.494c0.105-0.056,0.216-0.098,0.32-0.158l9.17-5.294	c0.312-0.181,0.504-0.517,0.5-0.877L31.75,23.327l4.015,2.258V35.588z M42.631,32.462c-1.056,1.83-2.84,3.086-4.884,3.483	c0.004-0.12,0.018-0.237,0.018-0.357V25c0-0.361-0.195-0.694-0.51-0.872l-10.329-5.81l3.964-2.348l8.662,5.002	c1.946,1.123,3.338,2.937,3.92,5.107C44.053,28.249,43.754,30.517,42.631,32.462z"></path>
        </svg>
      </div>
      
      <form
          hx-post="/model_name/"
          hx-trigger="submit"
          hx-target="#alert"
          hx-swap="outerHTML"
          hx-include="#model_x">
        <select name="model" id="model_x">
          <option value="qwen2:0.5b">qwen2:0.5b</option>
          <option value="deepseek-r1:1.5b">deepseek-r1:1.5b</option>
        </select>
        <button type="submit" style="background-color: blue;">Change Model</button>
      </form>
    </header>
    
    <main>
      <div id="messages"></div>
    </main>

    <footer>
      <form
          hx-post="/send_message/"
          hx-trigger="submit"
          hx-target="#messages"
          hx-swap="outerHTML"
          hx-include="#input">
        <input type="text" id="input" name="question" placeholder="Enter your message">
        <button id ="sendb" type="submit">Send</button>
      </form>
      <form 
          hx-post="/uploadfile/" 
          hx-encoding="multipart/form-data"
          hx-trigger="submit"
          hx-target="#alert"
          hx-swap="outerHTML">
        <input type="file" id="file" name="file">
        <button id="send_question" type="submit" style="background-color: blueviolet;">Upload</button>
      </form>
      <div id="alert"></div>
    </footer>
  </div>
  <script>
    send=document.getElementById("sendb");
    send=true;
    if (send) {
      send.addEventListener("click", function() {
      console.log("send");
      ai_answer = document.getElementById("answer");
      if (ai_answer) {
        ai_answer.textContent = "";
        send=true;
        console.log("send");
      }
    });
    }
    
    // Get the messages element
    setInterval(function() {
      ai_answer = document.getElementById("answer");
      if (ai_answer && send) {
      // Scroll to the bottom of the messages element
      content_text = ai_answer.textContent;
      
      
      close_thinking = content_text.indexOf("</think>");
      if (close_thinking !== -1) {
        ai_answer.textContent = content_text.substring(close_thinking + 8);
      }
      send=false;
      }
    }, 5000);
  </script>

  
</body>
</html>
